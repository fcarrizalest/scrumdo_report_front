define(["module","backbone","app/collections/iterationsCollection","app/views/appshell/appshell","app/views/appshell/iterationview","app/collections/StoriesCollection"],function(e,o,r,n,t,i){var l=o.Router.extend({routes:{r1:"r1","view/:id":"view","*actions":"defaultRoute"}}),a=function(){var a=new l,s=new r,c=new i;c.url=e.config().basepath+"stories",c.fetch({reset:!0});var u=new n(a,s),p=new t;if(s.url=e.config().basepath+"iterations/actual",s.fetch({reset:!0}),console.log("pp"),console.log(e),void 0!=navigator.serviceWorker)if(navigator.serviceWorker.controller){console.log("tengo ya un controller");navigator.serviceWorker.controller.scriptURL}else navigator.serviceWorker.register("service-worker.js",{scope:"."}).then(function(e){});else console.log("Navegador sin SW");a.on("route:defaultRoute",function(){console.log("aaa"),u.render()}),a.on("route:view",function(e){p.model=s.get(e),p.render()}),a.on("route:r1",function(){}),o.history.start(),u.render()};return{initialize:a}});